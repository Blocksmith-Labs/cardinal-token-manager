{"version":3,"file":"instruction.js","sourceRoot":"","sources":["../../../../src/programs/tokenManager/instruction.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Metadata,\n  MetadataProgram,\n} from \"@metaplex-foundation/mpl-token-metadata\";\nimport type { BN } from \"@project-serum/anchor\";\nimport { AnchorProvider, Program } from \"@project-serum/anchor\";\nimport type { Wallet } from \"@saberhq/solana-contrib\";\nimport {\n  ASSOCIATED_TOKEN_PROGRAM_ID,\n  TOKEN_PROGRAM_ID,\n} from \"@solana/spl-token\";\nimport type {\n  AccountMeta,\n  Connection,\n  PublicKey,\n  TransactionInstruction,\n} from \"@solana/web3.js\";\nimport {\n  SystemProgram,\n  SYSVAR_INSTRUCTIONS_PUBKEY,\n  SYSVAR_RENT_PUBKEY,\n} from \"@solana/web3.js\";\n\nimport { findAta } from \"../..\";\nimport { CRANK_KEY, TokenManagerState } from \".\";\nimport type {\n  InvalidationType,\n  TOKEN_MANAGER_PROGRAM,\n  TokenManagerKind,\n} from \"./constants\";\nimport { TOKEN_MANAGER_ADDRESS, TOKEN_MANAGER_IDL } from \"./constants\";\nimport {\n  findClaimReceiptId,\n  findMintCounterId,\n  findMintManagerId,\n  findReceiptMintManagerId,\n  findTokenManagerAddress,\n  findTransferReceiptId,\n} from \"./pda\";\nimport { getRemainingAccountsForKind } from \"./utils\";\n\nexport const initMintCounter = async (\n  connection: Connection,\n  wallet: Wallet,\n  mint: PublicKey\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n  const [mintCounterId, _mintCounterBump] = await findMintCounterId(mint);\n  return tokenManagerProgram.instruction.initMintCounter(mint, {\n    accounts: {\n      mintCounter: mintCounterId,\n      payer: wallet.publicKey,\n      systemProgram: SystemProgram.programId,\n    },\n  });\n};\n\nexport const init = async (\n  connection: Connection,\n  wallet: Wallet,\n  mint: PublicKey,\n  issuerTokenAccountId: PublicKey,\n  amount: BN,\n  kind: TokenManagerKind,\n  invalidationType: InvalidationType,\n  numInvalidators = 1,\n  payer?: PublicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [[tokenManagerId], [mintCounterId]] = await Promise.all([\n    findTokenManagerAddress(mint),\n    findMintCounterId(mint),\n  ]);\n\n  return [\n    tokenManagerProgram.instruction.init(\n      {\n        numInvalidators,\n        amount,\n        kind,\n        invalidationType,\n      },\n      {\n        accounts: {\n          tokenManager: tokenManagerId,\n          mintCounter: mintCounterId,\n          mint: mint,\n          issuer: wallet.publicKey,\n          payer: payer || wallet.publicKey,\n          issuerTokenAccount: issuerTokenAccountId,\n          systemProgram: SystemProgram.programId,\n        },\n      }\n    ),\n    tokenManagerId,\n  ];\n};\n\nexport const setClaimApprover = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  claimApproverId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.setClaimApprover(claimApproverId, {\n    accounts: {\n      tokenManager: tokenManagerId,\n      issuer: wallet.publicKey,\n    },\n  });\n};\n\nexport const setTransferAuthority = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  transferAuthorityId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.setTransferAuthority(\n    transferAuthorityId,\n    {\n      accounts: {\n        tokenManager: tokenManagerId,\n        issuer: wallet.publicKey,\n      },\n    }\n  );\n};\n\nexport const transfer = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  mint: PublicKey,\n  currentHolderTokenAccountId: PublicKey,\n  recipient: PublicKey,\n  recipientTokenAccountId: PublicKey,\n  remainingAcounts?: AccountMeta[]\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.transfer({\n    accounts: {\n      tokenManager: tokenManagerId,\n      mint: mint,\n      currentHolderTokenAccount: currentHolderTokenAccountId,\n      recipient: recipient,\n      recipientTokenAccount: recipientTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n    remainingAccounts: remainingAcounts ? remainingAcounts : [],\n  });\n};\n\nexport const addInvalidator = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  invalidatorId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.addInvalidator(invalidatorId, {\n    accounts: {\n      tokenManager: tokenManagerId,\n      issuer: wallet.publicKey,\n    },\n  });\n};\n\nexport const issue = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  tokenManagerTokenAccountId: PublicKey,\n  issuerTokenAccountId: PublicKey,\n  payer = wallet.publicKey,\n  remainingAccounts?: AccountMeta[]\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n  return tokenManagerProgram.instruction.issue({\n    accounts: {\n      tokenManager: tokenManagerId,\n      tokenManagerTokenAccount: tokenManagerTokenAccountId,\n      issuer: wallet.publicKey,\n      issuerTokenAccount: issuerTokenAccountId,\n      payer: payer,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      systemProgram: SystemProgram.programId,\n    },\n    remainingAccounts: remainingAccounts ?? [],\n  });\n};\n\nexport const unissue = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  tokenManagerTokenAccountId: PublicKey,\n  issuerTokenAccountId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.unissue({\n    accounts: {\n      tokenManager: tokenManagerId,\n      tokenManagerTokenAccount: tokenManagerTokenAccountId,\n      issuer: wallet.publicKey,\n      issuerTokenAccount: issuerTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n  });\n};\n\nexport const updateInvalidationType = (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  invalidationType: InvalidationType\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n  return tokenManagerProgram.instruction.updateInvalidationType(\n    invalidationType,\n    {\n      accounts: {\n        tokenManager: tokenManagerId,\n        issuer: wallet.publicKey,\n      },\n    }\n  );\n};\n\nexport const claim = async (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  tokenManagerKind: TokenManagerKind,\n  mintId: PublicKey,\n  tokenManagerTokenAccountId: PublicKey,\n  recipientTokenAccountId: PublicKey,\n  claimReceipt: PublicKey | undefined\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const remainingAccounts = await getRemainingAccountsForKind(\n    mintId,\n    tokenManagerKind\n  );\n\n  return tokenManagerProgram.instruction.claim({\n    accounts: {\n      tokenManager: tokenManagerId,\n      tokenManagerTokenAccount: tokenManagerTokenAccountId,\n      mint: mintId,\n      recipient: wallet.publicKey,\n      recipientTokenAccount: recipientTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      systemProgram: SystemProgram.programId,\n    },\n    remainingAccounts: claimReceipt\n      ? [\n          ...remainingAccounts,\n          { pubkey: claimReceipt, isSigner: false, isWritable: true },\n        ]\n      : remainingAccounts,\n  });\n};\n\nexport const createClaimReceipt = async (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  claimApproverId: PublicKey,\n  payer = wallet.publicKey,\n  target = wallet.publicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [claimReceiptId] = await findClaimReceiptId(tokenManagerId, target);\n\n  return [\n    tokenManagerProgram.instruction.createClaimReceipt(target, {\n      accounts: {\n        tokenManager: tokenManagerId,\n        claimApprover: claimApproverId,\n        claimReceipt: claimReceiptId,\n        payer,\n        systemProgram: SystemProgram.programId,\n      },\n    }),\n    claimReceiptId,\n  ];\n};\n\nexport const creatMintManager = async (\n  connection: Connection,\n  wallet: Wallet,\n  mintId: PublicKey,\n  payer = wallet.publicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [mintManagerId, _mintManagerBump] = await findMintManagerId(mintId);\n\n  return [\n    tokenManagerProgram.instruction.createMintManager({\n      accounts: {\n        mintManager: mintManagerId,\n        mint: mintId,\n        freezeAuthority: wallet.publicKey,\n        payer: payer,\n        tokenProgram: TOKEN_PROGRAM_ID,\n        systemProgram: SystemProgram.programId,\n      },\n    }),\n    mintManagerId,\n  ];\n};\n\nexport const closeMintManager = async (\n  connection: Connection,\n  wallet: Wallet,\n  mintId: PublicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [mintManagerId] = await findMintManagerId(mintId);\n\n  return [\n    tokenManagerProgram.instruction.closeMintManager({\n      accounts: {\n        mintManager: mintManagerId,\n        mint: mintId,\n        freezeAuthority: wallet.publicKey,\n        payer: wallet.publicKey,\n        tokenProgram: TOKEN_PROGRAM_ID,\n      },\n    }),\n    mintManagerId,\n  ];\n};\n\nexport const claimReceiptMint = async (\n  connection: Connection,\n  wallet: Wallet,\n  name: string,\n  tokenManagerId: PublicKey,\n  receiptMintId: PublicKey,\n  payer = wallet.publicKey\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [\n    receiptMintMetadataId,\n    recipientTokenAccountId,\n    [receiptMintManagerId],\n  ] = await Promise.all([\n    Metadata.getPDA(receiptMintId),\n    findAta(receiptMintId, wallet.publicKey),\n    findReceiptMintManagerId(),\n  ]);\n\n  return tokenManagerProgram.instruction.claimReceiptMint(name, {\n    accounts: {\n      tokenManager: tokenManagerId,\n      receiptMint: receiptMintId,\n      receiptMintMetadata: receiptMintMetadataId,\n      recipientTokenAccount: recipientTokenAccountId,\n      issuer: wallet.publicKey,\n      payer: payer,\n      receiptMintManager: receiptMintManagerId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      associatedToken: ASSOCIATED_TOKEN_PROGRAM_ID,\n      systemProgram: SystemProgram.programId,\n      tokenMetadataProgram: MetadataProgram.PUBKEY,\n      rent: SYSVAR_RENT_PUBKEY,\n    },\n  });\n};\n\nexport const invalidate = async (\n  connection: Connection,\n  wallet: Wallet,\n  mintId: PublicKey,\n  tokenManagerId: PublicKey,\n  tokenManagerKind: TokenManagerKind,\n  tokenManagerState: TokenManagerState,\n  tokenManagerTokenAccountId: PublicKey,\n  recipientTokenAccountId: PublicKey,\n  returnAccounts: AccountMeta[]\n): Promise<TransactionInstruction> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const transferAccounts = await getRemainingAccountsForKind(\n    mintId,\n    tokenManagerKind\n  );\n\n  return tokenManagerProgram.instruction.invalidate({\n    accounts: {\n      tokenManager: tokenManagerId,\n      tokenManagerTokenAccount: tokenManagerTokenAccountId,\n      mint: mintId,\n      recipientTokenAccount: recipientTokenAccountId,\n      invalidator: wallet.publicKey,\n      collector: CRANK_KEY,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      rent: SYSVAR_RENT_PUBKEY,\n    },\n    remainingAccounts: [\n      ...(tokenManagerState === TokenManagerState.Claimed\n        ? transferAccounts\n        : []),\n      ...returnAccounts,\n    ],\n  });\n};\n\nexport const createTransferReceipt = async (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  target: PublicKey,\n  payer?: PublicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [transferReceiptId] = await findTransferReceiptId(tokenManagerId);\n  return [\n    tokenManagerProgram.instruction.createTransferReceipt(target, {\n      accounts: {\n        tokenManager: tokenManagerId,\n        transferAuthority: wallet.publicKey,\n        transferReceipt: transferReceiptId,\n        payer: payer ?? wallet.publicKey,\n        systemProgram: SystemProgram.programId,\n      },\n    }),\n    transferReceiptId,\n  ];\n};\n\nexport const updateTransferReceipt = async (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  target: PublicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [transferReceiptId] = await findTransferReceiptId(tokenManagerId);\n  return [\n    tokenManagerProgram.instruction.updateTransferReceipt(target, {\n      accounts: {\n        tokenManager: tokenManagerId,\n        transferAuthority: wallet.publicKey,\n        transferReceipt: transferReceiptId,\n      },\n    }),\n    transferReceiptId,\n  ];\n};\n\nexport const closeTransferReceipt = async (\n  connection: Connection,\n  wallet: Wallet,\n  tokenManagerId: PublicKey,\n  reipient?: PublicKey\n): Promise<[TransactionInstruction, PublicKey]> => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  const [transferReceiptId] = await findTransferReceiptId(tokenManagerId);\n\n  return [\n    tokenManagerProgram.instruction.closeTransferReceipt({\n      accounts: {\n        tokenManager: tokenManagerId,\n        transferAuthority: wallet.publicKey,\n        transferReceipt: transferReceiptId,\n        recipient: reipient ?? wallet.publicKey,\n      },\n    }),\n    transferReceiptId,\n  ];\n};\n\nexport const delegate = (\n  connection: Connection,\n  wallet: Wallet,\n  mintId: PublicKey,\n  tokenManagerId: PublicKey,\n  mintManagerId: PublicKey,\n  recipient: PublicKey,\n  recipientTokenAccountId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.delegate({\n    accounts: {\n      tokenManager: tokenManagerId,\n      mint: mintId,\n      mintManager: mintManagerId,\n      recipient: recipient,\n      recipientTokenAccount: recipientTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n  });\n};\n\nexport const undelegate = (\n  connection: Connection,\n  wallet: Wallet,\n  mintId: PublicKey,\n  tokenManagerId: PublicKey,\n  mintManagerId: PublicKey,\n  recipient: PublicKey,\n  recipientTokenAccountId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n\n  return tokenManagerProgram.instruction.undelegate({\n    accounts: {\n      tokenManager: tokenManagerId,\n      mint: mintId,\n      mintManager: mintManagerId,\n      recipient: recipient,\n      recipientTokenAccount: recipientTokenAccountId,\n      tokenProgram: TOKEN_PROGRAM_ID,\n    },\n  });\n};\n\nexport const send = (\n  connection: Connection,\n  wallet: Wallet,\n  mintId: PublicKey,\n  tokenManagerId: PublicKey,\n  mintManagerId: PublicKey,\n  recipient: PublicKey,\n  recipientTokenAccountId: PublicKey,\n  target: PublicKey,\n  targetTokenAccountId: PublicKey\n): TransactionInstruction => {\n  const provider = new AnchorProvider(connection, wallet, {});\n  const tokenManagerProgram = new Program<TOKEN_MANAGER_PROGRAM>(\n    TOKEN_MANAGER_IDL,\n    TOKEN_MANAGER_ADDRESS,\n    provider\n  );\n  return tokenManagerProgram.instruction.send({\n    accounts: {\n      tokenManager: tokenManagerId,\n      mint: mintId,\n      mintManager: mintManagerId,\n      recipient: recipient,\n      recipientTokenAccount: recipientTokenAccountId,\n      target: target,\n      targetTokenAccount: targetTokenAccountId,\n      payer: wallet.publicKey,\n      associatedTokenProgram: ASSOCIATED_TOKEN_PROGRAM_ID,\n      tokenProgram: TOKEN_PROGRAM_ID,\n      systemProgram: SystemProgram.programId,\n      rent: SYSVAR_RENT_PUBKEY,\n      instructions: SYSVAR_INSTRUCTIONS_PUBKEY,\n    },\n  });\n};\n"]}